(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3116,e=>{"use strict";e.s(["Clock",()=>t],3116);let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},87130,e=>{"use strict";e.s(["Filter",()=>t],87130);let t=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},1568,e=>{"use strict";e.s(["StatusBadge",()=>a]);var t=e.i(43476),s=e.i(75157);function a(e){let{status:a,className:n}=e;return(0,t.jsx)("span",{className:(0,s.cn)("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",(e=>{switch(e){case"DRAFT":default:return"bg-gray-100 text-gray-800";case"PROCESSING":return"bg-blue-100 text-blue-800";case"READY_FOR_REVIEW":return"bg-yellow-100 text-yellow-800";case"APPROVED":case"OK":return"bg-green-100 text-green-800";case"REJECTED":case"MISSING":return"bg-red-100 text-red-800";case"ARCHIVED":case"N_A":return"bg-gray-100 text-gray-600";case"PENDING":return"bg-orange-100 text-orange-800"}})(a),n),children:(e=>{switch(e){case"READY_FOR_REVIEW":return"Ready for Review";case"N_A":return"N/A";default:return e.charAt(0)+e.slice(1).toLowerCase().replace("_"," ")}})(a)})}},38298,e=>{"use strict";e.s(["default",()=>C],38298);var t=e.i(43476),s=e.i(71645),a=e.i(17255),n=e.i(18566),r=e.i(19455),i=e.i(15288),l=e.i(87486),c=e.i(1568),d=e.i(31343),o=e.i(75254);let m=(0,o.default)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]);var u=e.i(3116);let x=(0,o.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),h=(0,o.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),f=(0,o.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var p=e.i(78583),g=e.i(87130),N=e.i(1851),j=e.i(77241),v=e.i(55545),D=e.i(55024),y=e.i(99151),w=e.i(45110),b=e.i(81092);function I(e,t){let s=(0,b.toDate)(e)-(0,b.toDate)(t);return s<0?-1:s>0?1:s}var M=e.i(34662);function E(e,t){return function(e,t,s){var a,n;let r,i=(0,D.getDefaultOptions)(),l=null!=(n=null!=(a=null==s?void 0:s.locale)?a:i.locale)?n:v.defaultLocale,c=I(e,t);if(isNaN(c))throw RangeError("Invalid time value");let d=Object.assign({},s,{addSuffix:null==s?void 0:s.addSuffix,comparison:c}),[o,m]=(0,w.normalizeDates)(null==s?void 0:s.in,...c>0?[t,e]:[e,t]),u=function(e,t,s){var a;return(a=void 0,e=>{let t=(a?Math[a]:Math.trunc)(e);return 0===t?0:t})(((0,b.toDate)(e)-(0,b.toDate)(t))/1e3)}(m,o),x=Math.round((u-((0,y.getTimezoneOffsetInMilliseconds)(m)-(0,y.getTimezoneOffsetInMilliseconds)(o))/1e3)/60);if(x<2)if(null==s?void 0:s.includeSeconds)if(u<5)return l.formatDistance("lessThanXSeconds",5,d);else if(u<10)return l.formatDistance("lessThanXSeconds",10,d);else if(u<20)return l.formatDistance("lessThanXSeconds",20,d);else if(u<40)return l.formatDistance("halfAMinute",0,d);else if(u<60)return l.formatDistance("lessThanXMinutes",1,d);else return l.formatDistance("xMinutes",1,d);else if(0===x)return l.formatDistance("lessThanXMinutes",1,d);else return l.formatDistance("xMinutes",x,d);if(x<45)return l.formatDistance("xMinutes",x,d);if(x<90)return l.formatDistance("aboutXHours",1,d);if(x<M.minutesInDay){let e=Math.round(x/60);return l.formatDistance("aboutXHours",e,d)}if(x<2520)return l.formatDistance("xDays",1,d);else if(x<M.minutesInMonth){let e=Math.round(x/M.minutesInDay);return l.formatDistance("xDays",e,d)}else if(x<2*M.minutesInMonth)return r=Math.round(x/M.minutesInMonth),l.formatDistance("aboutXMonths",r,d);if((r=function(e,t,s){let[a,n,r]=(0,w.normalizeDates)(void 0,e,e,t),i=I(n,r),l=Math.abs(function(e,t,s){let[a,n]=(0,w.normalizeDates)(void 0,e,t);return 12*(a.getFullYear()-n.getFullYear())+(a.getMonth()-n.getMonth())}(n,r));if(l<1)return 0;1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*l);let c=I(n,r)===-i;(function(e,t){let s=(0,b.toDate)(e,void 0);return+function(e,t){let s=(0,b.toDate)(e,null==t?void 0:t.in);return s.setHours(23,59,59,999),s}(s,void 0)==+function(e,t){let s=(0,b.toDate)(e,null==t?void 0:t.in),a=s.getMonth();return s.setFullYear(s.getFullYear(),a+1,0),s.setHours(23,59,59,999),s}(s,t)})(a)&&1===l&&1===I(a,r)&&(c=!1);let d=i*(l-c);return 0===d?0:d}(m,o))<12){let e=Math.round(x/M.minutesInMonth);return l.formatDistance("xMonths",e,d)}{let e=r%12,t=Math.trunc(r/12);return e<3?l.formatDistance("aboutXYears",t,d):e<9?l.formatDistance("overXYears",t,d):l.formatDistance("almostXYears",t+1,d)}}(e,(0,j.constructFrom)(e,Date.now()),t)}function C(){let{data:e}=(0,a.useSession)(),o=(0,n.useRouter)(),[j,v]=(0,s.useState)([]),[D,y]=(0,s.useState)(!0),[w,b]=(0,s.useState)("all");(0,s.useEffect)(()=>{I();let e=setInterval(()=>{j.some(e=>["PENDING","RUNNING"].includes(e.status))&&I()},5e3);return()=>clearInterval(e)},[]);let I=async()=>{try{let e=await fetch("/api/runs");if(e.ok){let t=await e.json();v(t.data)}else v([{id:"run-1",tenderId:"tender-1",tenderTitle:"IT Infrastructure Modernization Project",pipelineName:"phase1-mvp",status:"RUNNING",startedAt:new Date(Date.now()-3e5),progress:65,currentStep:"field-extraction",logs:[{timestamp:new Date(Date.now()-3e5),level:"INFO",message:"Pipeline started",step:"init"},{timestamp:new Date(Date.now()-24e4),level:"INFO",message:"Documents parsed successfully",step:"document-parsing"},{timestamp:new Date(Date.now()-12e4),level:"INFO",message:"Extracting scope information",step:"field-extraction"},{timestamp:new Date(Date.now()-3e4),level:"WARN",message:"Some eligibility criteria may be incomplete",step:"field-extraction"}]},{id:"run-2",tenderId:"tender-2",tenderTitle:"Healthcare System Upgrade",pipelineName:"phase1-mvp",status:"COMPLETED",startedAt:new Date(Date.now()-72e5),finishedAt:new Date(Date.now()-54e5),progress:100,logs:[{timestamp:new Date(Date.now()-72e5),level:"INFO",message:"Pipeline started",step:"init"},{timestamp:new Date(Date.now()-648e4),level:"INFO",message:"Documents parsed successfully",step:"document-parsing"},{timestamp:new Date(Date.now()-576e4),level:"INFO",message:"Field extraction completed",step:"field-extraction"},{timestamp:new Date(Date.now()-54e5),level:"INFO",message:"Pipeline completed successfully",step:"finalization"}]},{id:"run-3",tenderId:"tender-3",tenderTitle:"Public Transport Enhancement",pipelineName:"phase1-mvp",status:"FAILED",startedAt:new Date(Date.now()-216e5),finishedAt:new Date(Date.now()-198e5),progress:45,currentStep:"field-extraction",errorMessage:"Failed to extract eligibility criteria - insufficient citation matches",logs:[{timestamp:new Date(Date.now()-216e5),level:"INFO",message:"Pipeline started",step:"init"},{timestamp:new Date(Date.now()-2088e4),level:"INFO",message:"Documents parsed successfully",step:"document-parsing"},{timestamp:new Date(Date.now()-198e5),level:"ERROR",message:"Failed to extract eligibility criteria - insufficient citation matches",step:"field-extraction"}]},{id:"run-4",tenderId:"tender-4",tenderTitle:"Environmental Monitoring System",pipelineName:"phase1-mvp",status:"PENDING",startedAt:new Date,logs:[{timestamp:new Date,level:"INFO",message:"Run queued for processing",step:"init"}]}])}catch(e){console.error("Error fetching runs:",e)}finally{y(!1)}},M=j.filter(e=>{switch(w){case"active":return["PENDING","RUNNING"].includes(e.status);case"completed":return"COMPLETED"===e.status;case"failed":return"FAILED"===e.status;default:return!0}}),C={all:j.length,active:j.filter(e=>["PENDING","RUNNING"].includes(e.status)).length,completed:j.filter(e=>"COMPLETED"===e.status).length,failed:j.filter(e=>"FAILED"===e.status).length};return D?(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Pipeline Runs"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Monitor the progress of document processing pipelines"})]}),(0,t.jsxs)(r.Button,{onClick:()=>I(),children:[(0,t.jsx)(f,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,t.jsx)(i.Card,{children:(0,t.jsx)(i.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Runs"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:C.all})]}),(0,t.jsx)(d.Play,{className:"h-8 w-8 text-blue-600"})]})})}),(0,t.jsx)(i.Card,{children:(0,t.jsx)(i.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:C.active})]}),(0,t.jsx)(u.Clock,{className:"h-8 w-8 text-orange-600"})]})})}),(0,t.jsx)(i.Card,{children:(0,t.jsx)(i.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Completed"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-green-600",children:C.completed})]}),(0,t.jsx)(x,{className:"h-8 w-8 text-green-600"})]})})}),(0,t.jsx)(i.Card,{children:(0,t.jsx)(i.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Failed"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-red-600",children:C.failed})]}),(0,t.jsx)(h,{className:"h-8 w-8 text-red-600"})]})})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,t.jsx)(g.Filter,{className:"h-4 w-4 text-gray-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Filter:"}),["all","active","completed","failed"].map(e=>(0,t.jsxs)(r.Button,{variant:w===e?"default":"outline",size:"sm",onClick:()=>b(e),children:[e.charAt(0).toUpperCase()+e.slice(1),(0,t.jsx)(l.Badge,{variant:"secondary",className:"ml-2",children:C[e]})]},e))]}),(0,t.jsxs)("div",{className:"space-y-4",children:[M.map(e=>(0,t.jsx)(i.Card,{className:"hover:shadow-md transition-shadow",children:(0,t.jsxs)(i.CardContent,{className:"pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(e=>{switch(e){case"PENDING":return(0,t.jsx)(u.Clock,{className:"h-4 w-4 text-orange-500"});case"RUNNING":return(0,t.jsx)(d.Play,{className:"h-4 w-4 text-blue-500"});case"COMPLETED":return(0,t.jsx)(x,{className:"h-4 w-4 text-green-500"});case"FAILED":return(0,t.jsx)(h,{className:"h-4 w-4 text-red-500"});case"CANCELLED":return(0,t.jsx)(m,{className:"h-4 w-4 text-gray-500"});default:return(0,t.jsx)(u.Clock,{className:"h-4 w-4 text-gray-500"})}})(e.status),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:e.tenderTitle}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,t.jsxs)("span",{children:["Pipeline: ",e.pipelineName]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:["Started ",(0,N.format)(new Date(e.startedAt),"MMM d, yyyy HH:mm")]}),e.finishedAt&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:["Duration: ",e.finishedAt?E(new Date(e.finishedAt),{addSuffix:!1}):"RUNNING"===e.status?E(new Date(e.startedAt),{addSuffix:!1}):"-"]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(c.StatusBadge,{status:e.status}),(0,t.jsxs)(r.Button,{variant:"outline",size:"sm",onClick:()=>o.push("/tenders/".concat(e.tenderId)),children:[(0,t.jsx)(p.FileText,{className:"h-4 w-4 mr-2"}),"View Tender"]})]})]}),void 0!==e.progress&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Progress ",e.currentStep&&"(".concat(e.currentStep,")")]}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:[e.progress,"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.progress,"%")}})})]}),e.errorMessage&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(h,{className:"h-4 w-4 text-red-600"}),(0,t.jsx)("span",{className:"text-sm font-medium text-red-800",children:"Error"})]}),(0,t.jsx)("p",{className:"text-sm text-red-700 mt-1",children:e.errorMessage})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Recent Activity"}),(0,t.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:e.logs.slice(-5).reverse().map((e,s)=>(0,t.jsxs)("div",{className:"flex items-start gap-2 text-xs",children:[(0,t.jsx)("span",{className:"text-gray-500 font-mono",children:(0,N.format)(new Date(e.timestamp),"HH:mm:ss")}),(0,t.jsx)(l.Badge,{variant:"ERROR"===e.level?"destructive":"WARN"===e.level?"secondary":"outline",className:"text-xs",children:e.level}),e.step&&(0,t.jsxs)("span",{className:"text-gray-500",children:["[",e.step,"]"]}),(0,t.jsx)("span",{className:"text-gray-700",children:e.message})]},s))})]})]})},e.id)),0===M.length&&(0,t.jsx)(i.Card,{children:(0,t.jsxs)(i.CardContent,{className:"py-12 text-center",children:[(0,t.jsx)(d.Play,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No runs found"}),(0,t.jsx)("p",{className:"text-gray-600",children:"all"===w?"No pipeline runs have been started yet.":"No ".concat(w," runs found.")})]})})]})]})}}]);
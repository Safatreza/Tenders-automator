module.exports=[68915,a=>{"use strict";a.s(["default",()=>C],68915);var b=a.i(87924),c=a.i(72131),d=a.i(75003),e=a.i(50944),f=a.i(99570),g=a.i(91119),h=a.i(86304),i=a.i(15913),j=a.i(25015),k=a.i(70106);let l=(0,k.default)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]);var m=a.i(41710);let n=(0,k.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),o=(0,k.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),p=(0,k.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var q=a.i(4720),r=a.i(69012),s=a.i(56711),t=a.i(42724),u=a.i(44513),v=a.i(52587),w=a.i(23464),x=a.i(57270),y=a.i(74016);function z(a,b){let c=(0,y.toDate)(a)-(0,y.toDate)(b);return c<0?-1:c>0?1:c}var A=a.i(59296);function B(a,b){return function(a,b,c){let d,e=(0,v.getDefaultOptions)(),f=c?.locale??e.locale??u.defaultLocale,g=z(a,b);if(isNaN(g))throw RangeError("Invalid time value");let h=Object.assign({},c,{addSuffix:c?.addSuffix,comparison:g}),[i,j]=(0,x.normalizeDates)(c?.in,...g>0?[b,a]:[a,b]),k=function(a,b,c){var d;return(d=void 0,a=>{let b=(d?Math[d]:Math.trunc)(a);return 0===b?0:b})(((0,y.toDate)(a)-(0,y.toDate)(b))/1e3)}(j,i),l=Math.round((k-((0,w.getTimezoneOffsetInMilliseconds)(j)-(0,w.getTimezoneOffsetInMilliseconds)(i))/1e3)/60);if(l<2)if(c?.includeSeconds)if(k<5)return f.formatDistance("lessThanXSeconds",5,h);else if(k<10)return f.formatDistance("lessThanXSeconds",10,h);else if(k<20)return f.formatDistance("lessThanXSeconds",20,h);else if(k<40)return f.formatDistance("halfAMinute",0,h);else if(k<60)return f.formatDistance("lessThanXMinutes",1,h);else return f.formatDistance("xMinutes",1,h);else if(0===l)return f.formatDistance("lessThanXMinutes",1,h);else return f.formatDistance("xMinutes",l,h);if(l<45)return f.formatDistance("xMinutes",l,h);if(l<90)return f.formatDistance("aboutXHours",1,h);if(l<A.minutesInDay){let a=Math.round(l/60);return f.formatDistance("aboutXHours",a,h)}if(l<2520)return f.formatDistance("xDays",1,h);else if(l<A.minutesInMonth){let a=Math.round(l/A.minutesInDay);return f.formatDistance("xDays",a,h)}else if(l<2*A.minutesInMonth)return d=Math.round(l/A.minutesInMonth),f.formatDistance("aboutXMonths",d,h);if((d=function(a,b,c){let[d,e,f]=(0,x.normalizeDates)(void 0,a,a,b),g=z(e,f),h=Math.abs(function(a,b,c){let[d,e]=(0,x.normalizeDates)(void 0,a,b);return 12*(d.getFullYear()-e.getFullYear())+(d.getMonth()-e.getMonth())}(e,f));if(h<1)return 0;1===e.getMonth()&&e.getDate()>27&&e.setDate(30),e.setMonth(e.getMonth()-g*h);let i=z(e,f)===-g;(function(a,b){let c=(0,y.toDate)(a,void 0);return+function(a,b){let c=(0,y.toDate)(a,b?.in);return c.setHours(23,59,59,999),c}(c,void 0)==+function(a,b){let c=(0,y.toDate)(a,b?.in),d=c.getMonth();return c.setFullYear(c.getFullYear(),d+1,0),c.setHours(23,59,59,999),c}(c,b)})(d)&&1===h&&1===z(d,f)&&(i=!1);let j=g*(h-i);return 0===j?0:j}(j,i))<12){let a=Math.round(l/A.minutesInMonth);return f.formatDistance("xMonths",a,h)}{let a=d%12,b=Math.trunc(d/12);return a<3?f.formatDistance("aboutXYears",b,h):a<9?f.formatDistance("overXYears",b,h):f.formatDistance("almostXYears",b+1,h)}}(a,(0,t.constructFrom)(a,Date.now()),b)}function C(){let{data:a}=(0,d.useSession)(),k=(0,e.useRouter)(),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)("all");(0,c.useEffect)(()=>{z();let a=setInterval(()=>{t.some(a=>["PENDING","RUNNING"].includes(a.status))&&z()},5e3);return()=>clearInterval(a)},[]);let z=async()=>{try{let a=await fetch("/api/runs");if(a.ok){let b=await a.json();u(b.data)}else u([{id:"run-1",tenderId:"tender-1",tenderTitle:"IT Infrastructure Modernization Project",pipelineName:"phase1-mvp",status:"RUNNING",startedAt:new Date(Date.now()-3e5),progress:65,currentStep:"field-extraction",logs:[{timestamp:new Date(Date.now()-3e5),level:"INFO",message:"Pipeline started",step:"init"},{timestamp:new Date(Date.now()-24e4),level:"INFO",message:"Documents parsed successfully",step:"document-parsing"},{timestamp:new Date(Date.now()-12e4),level:"INFO",message:"Extracting scope information",step:"field-extraction"},{timestamp:new Date(Date.now()-3e4),level:"WARN",message:"Some eligibility criteria may be incomplete",step:"field-extraction"}]},{id:"run-2",tenderId:"tender-2",tenderTitle:"Healthcare System Upgrade",pipelineName:"phase1-mvp",status:"COMPLETED",startedAt:new Date(Date.now()-72e5),finishedAt:new Date(Date.now()-54e5),progress:100,logs:[{timestamp:new Date(Date.now()-72e5),level:"INFO",message:"Pipeline started",step:"init"},{timestamp:new Date(Date.now()-648e4),level:"INFO",message:"Documents parsed successfully",step:"document-parsing"},{timestamp:new Date(Date.now()-576e4),level:"INFO",message:"Field extraction completed",step:"field-extraction"},{timestamp:new Date(Date.now()-54e5),level:"INFO",message:"Pipeline completed successfully",step:"finalization"}]},{id:"run-3",tenderId:"tender-3",tenderTitle:"Public Transport Enhancement",pipelineName:"phase1-mvp",status:"FAILED",startedAt:new Date(Date.now()-216e5),finishedAt:new Date(Date.now()-198e5),progress:45,currentStep:"field-extraction",errorMessage:"Failed to extract eligibility criteria - insufficient citation matches",logs:[{timestamp:new Date(Date.now()-216e5),level:"INFO",message:"Pipeline started",step:"init"},{timestamp:new Date(Date.now()-2088e4),level:"INFO",message:"Documents parsed successfully",step:"document-parsing"},{timestamp:new Date(Date.now()-198e5),level:"ERROR",message:"Failed to extract eligibility criteria - insufficient citation matches",step:"field-extraction"}]},{id:"run-4",tenderId:"tender-4",tenderTitle:"Environmental Monitoring System",pipelineName:"phase1-mvp",status:"PENDING",startedAt:new Date,logs:[{timestamp:new Date,level:"INFO",message:"Run queued for processing",step:"init"}]}])}catch(a){console.error("Error fetching runs:",a)}finally{w(!1)}},A=t.filter(a=>{switch(x){case"active":return["PENDING","RUNNING"].includes(a.status);case"completed":return"COMPLETED"===a.status;case"failed":return"FAILED"===a.status;default:return!0}}),C={all:t.length,active:t.filter(a=>["PENDING","RUNNING"].includes(a.status)).length,completed:t.filter(a=>"COMPLETED"===a.status).length,failed:t.filter(a=>"FAILED"===a.status).length};return v?(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):(0,b.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,b.jsx)("div",{className:"mb-8",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Pipeline Runs"}),(0,b.jsx)("p",{className:"text-gray-600 mt-2",children:"Monitor the progress of document processing pipelines"})]}),(0,b.jsxs)(f.Button,{onClick:()=>z(),children:[(0,b.jsx)(p,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Runs"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:C.all})]}),(0,b.jsx)(j.Play,{className:"h-8 w-8 text-blue-600"})]})})}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:C.active})]}),(0,b.jsx)(m.Clock,{className:"h-8 w-8 text-orange-600"})]})})}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Completed"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-green-600",children:C.completed})]}),(0,b.jsx)(n,{className:"h-8 w-8 text-green-600"})]})})}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Failed"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-red-600",children:C.failed})]}),(0,b.jsx)(o,{className:"h-8 w-8 text-red-600"})]})})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,b.jsx)(r.Filter,{className:"h-4 w-4 text-gray-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Filter:"}),["all","active","completed","failed"].map(a=>(0,b.jsxs)(f.Button,{variant:x===a?"default":"outline",size:"sm",onClick:()=>y(a),children:[a.charAt(0).toUpperCase()+a.slice(1),(0,b.jsx)(h.Badge,{variant:"secondary",className:"ml-2",children:C[a]})]},a))]}),(0,b.jsxs)("div",{className:"space-y-4",children:[A.map(a=>(0,b.jsx)(g.Card,{className:"hover:shadow-md transition-shadow",children:(0,b.jsxs)(g.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(a=>{switch(a){case"PENDING":return(0,b.jsx)(m.Clock,{className:"h-4 w-4 text-orange-500"});case"RUNNING":return(0,b.jsx)(j.Play,{className:"h-4 w-4 text-blue-500"});case"COMPLETED":return(0,b.jsx)(n,{className:"h-4 w-4 text-green-500"});case"FAILED":return(0,b.jsx)(o,{className:"h-4 w-4 text-red-500"});case"CANCELLED":return(0,b.jsx)(l,{className:"h-4 w-4 text-gray-500"});default:return(0,b.jsx)(m.Clock,{className:"h-4 w-4 text-gray-500"})}})(a.status),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-900",children:a.tenderTitle}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,b.jsxs)("span",{children:["Pipeline: ",a.pipelineName]}),(0,b.jsx)("span",{children:"•"}),(0,b.jsxs)("span",{children:["Started ",(0,s.format)(new Date(a.startedAt),"MMM d, yyyy HH:mm")]}),a.finishedAt&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{children:"•"}),(0,b.jsxs)("span",{children:["Duration: ",a.finishedAt?B(new Date(a.finishedAt),{addSuffix:!1}):"RUNNING"===a.status?B(new Date(a.startedAt),{addSuffix:!1}):"-"]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(i.StatusBadge,{status:a.status}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>k.push(`/tenders/${a.tenderId}`),children:[(0,b.jsx)(q.FileText,{className:"h-4 w-4 mr-2"}),"View Tender"]})]})]}),void 0!==a.progress&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Progress ",a.currentStep&&`(${a.currentStep})`]}),(0,b.jsxs)("span",{className:"text-sm text-gray-600",children:[a.progress,"%"]})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${a.progress}%`}})})]}),a.errorMessage&&(0,b.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(o,{className:"h-4 w-4 text-red-600"}),(0,b.jsx)("span",{className:"text-sm font-medium text-red-800",children:"Error"})]}),(0,b.jsx)("p",{className:"text-sm text-red-700 mt-1",children:a.errorMessage})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Recent Activity"}),(0,b.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:a.logs.slice(-5).reverse().map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-2 text-xs",children:[(0,b.jsx)("span",{className:"text-gray-500 font-mono",children:(0,s.format)(new Date(a.timestamp),"HH:mm:ss")}),(0,b.jsx)(h.Badge,{variant:"ERROR"===a.level?"destructive":"WARN"===a.level?"secondary":"outline",className:"text-xs",children:a.level}),a.step&&(0,b.jsxs)("span",{className:"text-gray-500",children:["[",a.step,"]"]}),(0,b.jsx)("span",{className:"text-gray-700",children:a.message})]},c))})]})]})},a.id)),0===A.length&&(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(j.Play,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No runs found"}),(0,b.jsx)("p",{className:"text-gray-600",children:"all"===x?"No pipeline runs have been started yet.":`No ${x} runs found.`})]})})]})]})}}];

//# sourceMappingURL=src_app_runs_page_tsx_2102ab04._.js.map